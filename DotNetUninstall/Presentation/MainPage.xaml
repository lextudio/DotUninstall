<Page
  x:Class="DotNetUninstall.Presentation.MainPage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:conv="using:DotNetUninstall.Presentation.Converters"
  xmlns:sys="using:System"
  x:Name="RootPage"
  Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
  <Page.Resources>
    <conv:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
    <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    <conv:BoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter" Invert="True" />
    <conv:StringEqualsToVisibilityConverter x:Key="StringEqualsToVisibilityConverter" />
    <conv:LifecycleStateToBrushConverter x:Key="LifecycleStateToBrushConverter" />
    <conv:ChannelDisplayConverter x:Key="ChannelDisplayConverter" />
    <conv:SecurityStateYesNoConverter x:Key="SecurityStateYesNoConverter" />
    <DataTemplate x:Key="HeaderTemplate">
      <StackPanel
        Margin="8,0,8,12"
        Padding="0"
        CornerRadius="6">
        <ToggleButton
          x:Name="GroupToggle"
          Padding="0"
          HorizontalAlignment="Stretch"
          Background="Transparent"
          BorderThickness="0"
          IsChecked="True">
          <StackPanel
            VerticalAlignment="Center"
            Orientation="Horizontal"
            Spacing="8">
            <TextBlock
              FontSize="{StaticResource FontSize.ChannelTitle}"
              FontWeight="SemiBold"
              Text=".NET" />
            <TextBlock
              FontSize="{StaticResource FontSize.ChannelTitle}"
              FontWeight="Bold"
              Text="{Binding Channel, Converter={StaticResource ChannelDisplayConverter}}" />
          </StackPanel>
        </ToggleButton>
        <Grid
          Margin="0,4,4,0"
          Background="Transparent"
          Visibility="{Binding IsChecked, ElementName=GroupToggle, Converter={StaticResource BoolToVisibilityConverter}}">
          <StackPanel>
            <!--  Badge row (two-segment style: label | value)  -->
            <StackPanel
              Margin="0,6,0,4"
              Orientation="Horizontal"
              Spacing="8">
              <!--  Release Type (e.g., LTS | 8)  -->
              <Grid Visibility="{Binding ReleaseType, Converter={StaticResource NullToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border
                  Grid.Column="0"
                  Padding="5,2"
                  Background="{StaticResource Badge.Release.Label}"
                  CornerRadius="4,0,0,4">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    FontWeight="SemiBold"
                    Foreground="White"
                    Text="Type" />
                </Border>
                <Border
                  Grid.Column="1"
                  Padding="5,2"
                  Background="{StaticResource Badge.Release.Value}"
                  CornerRadius="0">
                  <StackPanel Orientation="Horizontal" Spacing="2">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding ReleaseType}" />
                    <Button
                      Grid.Column="2"
                      Width="18"
                      Height="18"
                      Margin="2,0,0,0"
                      Padding="0"
                      Background="White"
                      BorderThickness="0"
                      Click="OnOpenChannelDownload"
                      CornerRadius="9"
                      Tag="{Binding ReleaseTypeInfoUrl}"
                      ToolTipService.ToolTip="Learn more">
                      <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="10"
                        FontWeight="Bold"
                        Foreground="{StaticResource Badge.Release.Label}"
                        Text="i" />
                    </Button>
                  </StackPanel>
                </Border>

              </Grid>
              <!--  Support Phase (Phase | value)  -->
              <Grid Visibility="{Binding SupportPhase, Converter={StaticResource NullToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border
                  Grid.Column="0"
                  Padding="5,2"
                  Background="{StaticResource Badge.Support.Label}"
                  CornerRadius="4,0,0,4">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    FontWeight="SemiBold"
                    Foreground="White"
                    Text="Support" />
                </Border>
                <Border
                  Grid.Column="1"
                  Padding="5,2"
                  Background="{StaticResource Badge.Support.Value}"
                  CornerRadius="0">
                  <StackPanel Orientation="Horizontal" Spacing="2">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding SupportPhase}" />
                    <Button
                      Grid.Column="2"
                      Width="18"
                      Height="18"
                      Margin="2,0,0,0"
                      Padding="0"
                      Background="White"
                      BorderThickness="0"
                      Click="OnOpenChannelDownload"
                      CornerRadius="9"
                      Tag="{Binding SupportPhaseInfoUrl}"
                      ToolTipService.ToolTip="Learn more">
                      <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="10"
                        FontWeight="Bold"
                        Foreground="{StaticResource Badge.Support.Value}"
                        Text="i" />
                    </Button>
                  </StackPanel>
                </Border>
              </Grid>
              <!--  EOL badge (EOL | date)  -->
              <Grid ToolTipService.ToolTip="{Binding EolDisplay}" Visibility="{Binding EolDateValue, Converter={StaticResource NullToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border
                  Grid.Column="0"
                  Padding="5,2"
                  Background="{StaticResource Badge.Eol.Label}"
                  CornerRadius="4,0,0,4">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    FontWeight="SemiBold"
                    Foreground="White"
                    Text="EOL" />
                </Border>
                <Border
                  Grid.Column="1"
                  Padding="5,2"
                  Background="{StaticResource Badge.Eol.Value}"
                  CornerRadius="0">
                  <StackPanel Orientation="Horizontal" Spacing="2">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding EolDateValue}" />
                    <Button
                      Grid.Column="2"
                      Width="18"
                      Height="18"
                      Margin="2,0,0,0"
                      Padding="0"
                      Background="White"
                      BorderThickness="0"
                      Click="OnOpenChannelDownload"
                      CornerRadius="9"
                      Tag="{Binding EolInfoUrl}"
                      ToolTipService.ToolTip="Learn more"
                      Visibility="{Binding EolInfoUrl, Converter={StaticResource NullToVisibilityConverter}}">
                      <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="10"
                        FontWeight="Bold"
                        Foreground="{StaticResource Badge.Eol.Value}"
                        Text="i" />
                    </Button>
                  </StackPanel>
                </Border>
              </Grid>
              <!--  MAUI EOL badge (MAUI EOL | date)  -->
              <Grid ToolTipService.ToolTip="MAUI End of life" Visibility="{Binding MauiEolDateValue, Converter={StaticResource NullToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border
                  Grid.Column="0"
                  Padding="5,2"
                  Background="{StaticResource Badge.MauiEol.Label}"
                  CornerRadius="4,0,0,4">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    FontWeight="SemiBold"
                    Foreground="White"
                    Text="MAUI EOL" />
                </Border>
                <Border
                  Grid.Column="1"
                  Padding="5,2"
                  Background="{StaticResource Badge.MauiEol.Value}"
                  CornerRadius="0">
                  <StackPanel Orientation="Horizontal" Spacing="2">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding MauiEolDateValue}" />
                    <Button
                      Grid.Column="2"
                      Width="18"
                      Height="18"
                      Margin="2,0,0,0"
                      Padding="0"
                      Background="White"
                      BorderThickness="0"
                      Click="OnOpenChannelDownload"
                      CornerRadius="9"
                      Tag="{Binding MauiEolInfoUrl}"
                      ToolTipService.ToolTip="Learn more"
                      Visibility="{Binding MauiEolInfoUrl, Converter={StaticResource NullToVisibilityConverter}}">
                      <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="10"
                        FontWeight="Bold"
                        Foreground="{StaticResource Badge.MauiEol.Value}"
                        Text="i" />
                    </Button>
                  </StackPanel>
                </Border>
              </Grid>
              <!--  Latest missing (normal)  -->
              <Grid Visibility="{Binding ShowLatestRelevantMissingNormal, Converter={StaticResource BoolToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border
                  Grid.Column="0"
                  Padding="5,2"
                  Background="{StaticResource Badge.Latest.Label}"
                  CornerRadius="4,0,0,4">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    FontWeight="SemiBold"
                    Foreground="White"
                    Text="Latest" />
                </Border>
                <Border
                  Grid.Column="1"
                  Padding="5,2"
                  Background="{StaticResource Badge.Latest.Value}"
                  CornerRadius="0,4,4,0">
                  <StackPanel Orientation="Horizontal" Spacing="2">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding LatestRelevantVersion}" />
                    <Button
                      Width="18"
                      Height="18"
                      Margin="2,0,0,0"
                      Padding="0"
                      Background="White"
                      BorderThickness="0"
                      Click="OnOpenChannelDownload"
                      CornerRadius="9"
                      Tag="{Binding ChannelDownloadUrl}"
                      ToolTipService.ToolTip="Download">
                      <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="{StaticResource FontSize.Badge}"
                        FontWeight="Bold"
                        Foreground="{StaticResource Badge.Latest.Value}"
                        Text="i" />
                    </Button>
                  </StackPanel>
                </Border>
              </Grid>
              <!--  Latest missing (security)  -->
              <Grid Visibility="{Binding ShowLatestRelevantMissingSecurity, Converter={StaticResource BoolToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Border
                  Grid.Column="0"
                  Padding="5,2"
                  Background="{StaticResource Brush.Security.Alert}"
                  CornerRadius="4,0,0,4">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    FontWeight="SemiBold"
                    Foreground="White"
                    Text="Latest" />
                </Border>
                <Border
                  Grid.Column="1"
                  Padding="5,2"
                  Background="{StaticResource Brush.Security.Warning}"
                  CornerRadius="0,4,4,0">
                  <StackPanel Orientation="Horizontal" Spacing="2">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding LatestRelevantVersion}" />
                    <Button
                      Width="18"
                      Height="18"
                      Margin="2,0,0,0"
                      Padding="0"
                      Background="White"
                      BorderThickness="0"
                      Click="OnOpenChannelDownload"
                      CornerRadius="9"
                      Tag="{Binding ChannelDownloadUrl}"
                      ToolTipService.ToolTip="Download">
                      <TextBlock
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="{StaticResource FontSize.Badge}"
                        FontWeight="Bold"
                        Foreground="{StaticResource Brush.Security.Alert}"
                        Text="i" />
                    </Button>
                  </StackPanel>
                </Border>
              </Grid>
            </StackPanel>
            <ListView
              ItemTemplate="{StaticResource InstallEntryTemplate}"
              ItemsSource="{Binding Items}"
              SelectionMode="None" />
          </StackPanel>
        </Grid>
      </StackPanel>
    </DataTemplate>
    <DataTemplate x:Key="InstallEntryTemplate">
      <Grid
        MinHeight="48"
        Padding="4"
        ColumnDefinitions="*,Auto"
        ToolTipService.ToolTip="{Binding Reason}">
        <StackPanel
          Margin="4"
          Orientation="Vertical"
          Spacing="4">
          <StackPanel
            VerticalAlignment="Center"
            Orientation="Horizontal"
            Spacing="6">
            <TextBlock FontWeight="Bold" FontSize="{StaticResource FontSize.VersionPrimary}" Text="{Binding Version}" />
            <TextBlock
              MaxWidth="360"
              FontSize="{StaticResource FontSize.Badge}"
              Opacity="0.65"
              Text="{Binding DisplayName}"
              TextTrimming="CharacterEllipsis" />
          </StackPanel>
          <StackPanel
            VerticalAlignment="Center"
            Orientation="Horizontal"
            Spacing="6">
            <!--  Release Date badge: Release|yyyy-MM-dd with notes link  -->
            <Grid ToolTipService.ToolTip="View release notes" Visibility="{Binding ReleaseDate, Converter={StaticResource NullToVisibilityConverter}}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.ReleaseDate.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="Release" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.ReleaseDate.Value}"
                CornerRadius="0">
                <StackPanel Orientation="Horizontal" Spacing="2">
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    Foreground="White"
                    Text="{Binding ReleaseDateValue}" />
                  <Button
                    Grid.Column="2"
                    Width="18"
                    Height="18"
                    Margin="2,0,0,0"
                    Padding="0"
                    Background="White"
                    BorderThickness="0"
                    Click="OnOpenChannelDownload"
                    CornerRadius="9"
                    Tag="{Binding ReleaseNotesUrl}"
                    ToolTipService.ToolTip="Open release notes"
                    Visibility="{Binding ReleaseNotesUrl, Converter={StaticResource NullToVisibilityConverter}}">
                    <TextBlock
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      FontSize="10"
                      FontWeight="Bold"
                      Foreground="{StaticResource Badge.ReleaseDate.Label}"
                      Text="i" />
                  </Button>
                </StackPanel>
              </Border>
            </Grid>
            <!--  Stage badge: Stage|GA or Stage|Preview N / Stage|RC N  -->
            <Grid ToolTipService.ToolTip="Release stage">
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.Stage.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="Stage" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.Stage.Value}"
                CornerRadius="0,4,4,0">
                <StackPanel Orientation="Horizontal" Spacing="4">
                  <!--  Simpler: bind text via MultiBinding concept is heavier; use conditional visibility blocks  -->
                  <TextBlock
                    FontSize="{StaticResource FontSize.Badge}"
                    Foreground="White"
                    Text="GA"
                    Visibility="{Binding IsGa, Converter={StaticResource BoolToVisibilityConverter}}" />
                  <StackPanel
                    Orientation="Horizontal"
                    Spacing="2"
                    Visibility="{Binding IsGa, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding PreviewKindDisplay}" />
                    <TextBlock
                      FontSize="{StaticResource FontSize.Badge}"
                      Foreground="White"
                      Text="{Binding PreviewNumber}"
                      Visibility="{Binding PreviewNumber, Converter={StaticResource NullToVisibilityConverter}}" />
                  </StackPanel>
                </StackPanel>
              </Border>
            </Grid>
            <!--  Simplified secure status badge: Secure|Yes or Secure|No  -->
            <Grid ToolTipService.ToolTip="{Binding SecurityTooltip}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.Security.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="Secure" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.Security.Value}"
                CornerRadius="0,4,4,0">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  Foreground="White"
                  Text="{Binding SecurityStatus, Converter={StaticResource SecurityStateYesNoConverter}}" />
              </Border>
            </Grid>
            <!--  Out of support badge  -->
            <Grid ToolTipService.ToolTip="Out of support" Visibility="{Binding IsOutOfSupport, Converter={StaticResource BoolToVisibilityConverter}}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.Eol.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="EOL" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.Eol.Value}"
                CornerRadius="0,4,4,0">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  Foreground="White"
                  Text="Build" />
              </Border>
            </Grid>
            <!--  Architecture badge  -->
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.Arch.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="Arch" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.Arch.Value}"
                CornerRadius="0,4,4,0">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  Foreground="White"
                  Text="{Binding Architecture}" />
              </Border>
            </Grid>
            <!--  SubType badge  -->
            <Grid Visibility="{Binding SubType, Converter={StaticResource NullToVisibilityConverter}}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.SubType.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="Type" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.SubType.Value}"
                CornerRadius="0,4,4,0">
                <TextBlock
                  FontSize="11"
                  Foreground="White"
                  Text="{Binding SubType}" />
              </Border>
            </Grid>
            <!--  Reason badge (kept single segment due to potential length)  -->
            <Border
              Padding="5,2"
              Background="{StaticResource Badge.Reason.Background}"
              CornerRadius="4"
              Visibility="{Binding Reason, Converter={StaticResource NullToVisibilityConverter}}">
              <TextBlock
                MaxWidth="260"
                FontSize="{StaticResource FontSize.Badge}"
                Foreground="White"
                Text="{Binding Reason}"
                TextTrimming="CharacterEllipsis" />
            </Border>
            <!--  Removable badge  -->
            <Grid Visibility="{Binding CanUninstall, Converter={StaticResource BoolToVisibilityConverter}}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
              </Grid.ColumnDefinitions>
              <Border
                Grid.Column="0"
                Padding="5,2"
                Background="{StaticResource Badge.State.Label}"
                CornerRadius="4,0,0,4">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  FontWeight="SemiBold"
                  Foreground="White"
                  Text="State" />
              </Border>
              <Border
                Grid.Column="1"
                Padding="5,2"
                Background="{StaticResource Badge.State.Value}"
                CornerRadius="0,4,4,0">
                <TextBlock
                  FontSize="{StaticResource FontSize.Badge}"
                  Foreground="White"
                  Text="Removable" />
              </Border>
            </Grid>
          </StackPanel>
        </StackPanel>
        <Button
          Grid.Column="1"
          Margin="4"
          Command="{Binding ElementName=RootPage, Path=DataContext.UninstallCommand}"
          CommandParameter="{Binding}"
          Content="Uninstall"
          IsEnabled="{Binding CanUninstall}"
          Loaded="Button_Loaded" />
      </Grid>
    </DataTemplate>
  </Page.Resources>
  <Grid RowDefinitions="Auto,*,Auto">
    <StackPanel
      Grid.Row="0"
      Margin="0,4,0,4"
      Spacing="4">
      <!--  Snapshot / cache status banner  -->
      <Border
        Margin="8,8,8,0"
        Padding="8"
        Background="{StaticResource Brush.Banner.Snapshot.Background}"
        BorderBrush="{StaticResource Brush.Banner.Snapshot.Border}"
        BorderThickness="1"
        CornerRadius="6"
        Visibility="{Binding IsUsingSnapshot, Converter={StaticResource BoolToVisibilityConverter}}">
        <StackPanel
          VerticalAlignment="Center"
          Orientation="Horizontal"
          Spacing="8">
          <TextBlock
            FontSize="12"
            Foreground="{StaticResource Brush.Banner.Snapshot.Foreground}"
            Text="Using embedded metadata snapshot (offline)." />
        </StackPanel>
      </Border>
      <Border
        Margin="8,0,8,0"
        Padding="8"
        Background="{StaticResource Brush.Banner.Cached.Background}"
        BorderBrush="{StaticResource Brush.Banner.Cached.Border}"
        BorderThickness="1"
        CornerRadius="6"
        Visibility="{Binding IsUsingCachedLive, Converter={StaticResource BoolToVisibilityConverter}}">
        <StackPanel
          VerticalAlignment="Center"
          Orientation="Horizontal"
          Spacing="8">
          <TextBlock
            FontSize="12"
            Foreground="{StaticResource Brush.Banner.Cached.Foreground}"
            Text="On cached live metadata." />
        </StackPanel>
      </Border>
      <!--  Update available banner  -->
      <Border
        Margin="8,0,8,0"
        Padding="12"
        Background="{StaticResource Brush.Banner.Update.Background}"
        BorderBrush="{StaticResource Brush.Banner.Update.Border}"
        BorderThickness="1"
        CornerRadius="6"
        Visibility="{Binding HasUpdate, Converter={StaticResource BoolToVisibilityConverter}}">
        <StackPanel
          VerticalAlignment="Center"
          Orientation="Horizontal"
          Spacing="12">
          <TextBlock
            MaxWidth="640"
            FontSize="12"
            Foreground="{StaticResource Brush.Banner.Update.Foreground}"
            TextWrapping="WrapWholeWords">
            <Run Text="Update available: " />
            <Run Text="{Binding UpdateMessage}" />
          </TextBlock>
          <Button
            Padding="8,4"
            Click="OnOpenReleasePage"
            Content="Open Release Page" />
        </StackPanel>
      </Border>
      <!--  Elevation / sudo warning banner (macOS)  -->
      <Border
        Margin="8,0,8,0"
        Padding="12"
        Background="{StaticResource Brush.Banner.Elevation.Background}"
        BorderBrush="{StaticResource Brush.Banner.Elevation.Border}"
        BorderThickness="1"
        CornerRadius="6"
        Visibility="{Binding ShowElevationWarning, Converter={StaticResource BoolToVisibilityConverter}}">
        <StackPanel
          VerticalAlignment="Center"
          Orientation="Horizontal"
          Spacing="12">
          <TextBlock
            MaxWidth="640"
            FontSize="12"
            Foreground="{StaticResource Brush.Banner.Elevation.Foreground}"
            TextWrapping="WrapWholeWords">
            <Run Text="Running with elevated privileges (root). " />
            <Run Text="Original user: " />
            <Run Text="{Binding OriginalUser}" />
            <Run Text=". Uninstalls may affect the entire system. Proceed with caution." />
          </TextBlock>
          <Button
            Padding="8,4"
            VerticalAlignment="Center"
            Command="{Binding DismissElevationWarningCommand}"
            Content="Dismiss" />
        </StackPanel>
      </Border>
      <!--  Non-elevated offer banner (macOS)  -->
      <Border
        Margin="8,0,8,0"
        Padding="12"
        Background="{StaticResource Brush.Banner.NonElevated.Background}"
        BorderBrush="{StaticResource Brush.Banner.NonElevated.Border}"
        BorderThickness="1"
        CornerRadius="6"
        Visibility="{Binding ShowElevationOffer, Converter={StaticResource BoolToVisibilityConverter}}">
        <StackPanel
          VerticalAlignment="Center"
          Orientation="Horizontal"
          Spacing="12">
          <TextBlock
            MaxWidth="640"
            FontSize="12"
            Foreground="{StaticResource Brush.Banner.NonElevated.Foreground}"
            TextWrapping="WrapWholeWords">
            <Run Text="Some uninstall operations may require administrator rights. " />
            <Run Text="You can relaunch this app with elevated privileges." />
          </TextBlock>
          <StackPanel
            VerticalAlignment="Center"
            Orientation="Horizontal"
            Spacing="8">
            <Button
              Padding="10,4"
              Command="{Binding ElevateCommand}"
              Content="Relaunch as Administrator" />
            <Button
              Padding="8,4"
              Command="{Binding DismissElevationOfferCommand}"
              Content="Dismiss" />
          </StackPanel>
        </StackPanel>
      </Border>
    </StackPanel>
    <Pivot x:Name="MainPivot" Grid.Row="1">
      <PivotItem Header="Runtimes">
        <ScrollViewer>
          <StackPanel>
            <TextBlock
              Margin="12,0,12,8"
              FontSize="12"
              Opacity="0.7"><Run Text="Count: " /><Run Text="{Binding RuntimeCount}" /></TextBlock>
            <ItemsControl ItemTemplate="{StaticResource HeaderTemplate}" ItemsSource="{Binding GroupedRuntimeItems}" />
          </StackPanel>
        </ScrollViewer>
      </PivotItem>
      <PivotItem Header="SDKs">
        <ScrollViewer>
          <StackPanel>
            <TextBlock
              Margin="12,0,12,8"
              FontSize="12"
              Opacity="0.7"><Run Text="Count: " /><Run Text="{Binding SdkCount}" /></TextBlock>
            <ItemsControl ItemTemplate="{StaticResource HeaderTemplate}" ItemsSource="{Binding GroupedSdkItems}" />
          </StackPanel>
        </ScrollViewer>
      </PivotItem>
      <PivotItem Header="Settings">
        <ScrollViewer>
          <StackPanel Padding="12" Spacing="16">
            <TextBlock
              FontSize="14"
              FontWeight="Bold"
              Text="Application" />
            <StackPanel
              VerticalAlignment="Center"
              Orientation="Horizontal"
              Spacing="8">
              <TextBlock FontWeight="SemiBold" Text="Version:" />
              <TextBlock Text="{Binding AppVersion}" />
            </StackPanel>
            <Button
              Padding="12,6"
              Command="{Binding CheckUpdateNowCommand}"
              Content="Check for Updates Now" />
            <Button
              Padding="12,6"
              Command="{Binding ClearCacheCommand}"
              Content="Clear Metadata Cache" />
            <TextBlock
              FontSize="12"
              Text="{Binding UpdateMessage}"
              TextWrapping="WrapWholeWords" />
            <TextBlock
              FontSize="12"
              Opacity="0.6"
              Text="Manual check bypasses the once-per-day automatic delay." />
          </StackPanel>
        </ScrollViewer>
      </PivotItem>
    </Pivot>
  </Grid>
</Page>
